app_name = '{{ rails.app_name }}'

#
# Gems
#

remove_file "Gemfile"
run "touch Gemfile"

add_source 'https://rubygems.org'
gem "devise"
gem 'rails', '4.2.4'
gem 'sass-rails', '~> 5.0'
gem 'uglifier', '>= 1.3.0'
gem 'coffee-rails', '~> 4.1.0'
gem 'therubyracer', platforms: :ruby
gem 'jquery-rails'
gem 'turbolinks'
gem 'jbuilder', '~> 2.0'
gem 'pg'
gem 'sidekiq'
gem 'sinatra'

gem_group :development, :test do
  # Call 'byebug' anywhere in the code to stop execution and get a debugger console
  gem 'byebug'
end

gem_group :development do
  gem 'web-console', '~> 2.0'
  gem 'spring'
  gem 'capistrano', '~> 3.4.0'
  gem 'capistrano-bundler'
  gem 'capistrano-rails'
end

generate "devise:install"
generate "devise", "user"
rake "db:migrate"

environment 'config.action_mailer.default_url_options = {host: "http://localhost:3000"}', env: "development"
environment 'config.action_mailer.default_url_options = {host: "http://yourwebsite.example.com"}', env: "production"

remove_file "config/routes.rb"
file "config/routes.rb", <<-CODE
Rails.application.routes.draw do
  require 'sidekiq/web'
  mount Sidekiq::Web => '/sidekiq'

  devise_for :users
  resources :users
end
CODE


#
# Travis
#

file ".travis.yml", <<-CODE
language: ruby

rvm:
  - "2.2"

notifications:
  email:
    recipients:
      - jason@ackmanndickenson.com
      - will@ackmanndickenson.com
CODE


#
# Git
#

after_bundle do
  git :init
  git add: "."
  git commit: %Q{ -m 'Initial commit' }
end

